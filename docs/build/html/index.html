
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Welcome to Vulnerability Classification using OpenVAS tool’s documentation! &#8212; OpenVas Rest API 1.0.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="welcome-to-vulnerability-classification-using-openvas-tool-s-documentation">
<h1>Welcome to Vulnerability Classification using OpenVAS tool’s documentation!<a class="headerlink" href="#welcome-to-vulnerability-classification-using-openvas-tool-s-documentation" title="Permalink to this headline">¶</a></h1>
<p>This documentation have been generated for an Academic CSIRT project</p>
</div>
<div class="section" id="requirements">
<h1>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h1>
<p>Python 3.6</p>
<p>Flask 1.1.0</p>
<p>OpenVas 9.0</p>
<p>When the flask server starts for the first time read rights must be given to openvasmd.sock file</p>
<p>Just execute config.sh (./config.sh)</p>
</div>
<div class="section" id="start-openvas-instance">
<h1>Start OpenVas instance<a class="headerlink" href="#start-openvas-instance" title="Permalink to this headline">¶</a></h1>
<p>systemctl enable openvas-scanner</p>
<p>systemctl enable openvas-manager</p>
<p>systemctl enable openvas-gsa</p>
<p>(All in sudo)</p>
</div>
<div class="section" id="module-openvas">
<span id="functions-and-their-usages-using-a-flask-server"></span><h1>Functions and their usages using a flask server<a class="headerlink" href="#module-openvas" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-openvas"></span><dl class="function">
<dt id="openvas.create_connection">
<code class="sig-prename descclassname">openvas.</code><code class="sig-name descname">create_connection</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openvas.create_connection" title="Permalink to this definition">¶</a></dt>
<dd><p><a href="#id1"><span class="problematic" id="id2">**</span></a>Creates the connection*
This function allows user to create a connection with openvas manager using gvm. The UnixSocketConnection function
takes as a parameter a path that leads to openvasmd socket file (/var/run/openvasmd.sock) that exists in the VM that runs OpenVAS manager.
Read rights must be granted (sudo chmod a+rwx openvasmd.sock)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The connection that gives access to the OpenVAS interface.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="openvas.create_target">
<code class="sig-prename descclassname">openvas.</code><code class="sig-name descname">create_target</code><span class="sig-paren">(</span><em class="sig-param">gmp</em>, <em class="sig-param">hosts</em>, <em class="sig-param">target_name</em>, <em class="sig-param">target_comment=''</em>, <em class="sig-param">port_list=None</em>, <em class="sig-param">alive_tests=None</em><span class="sig-paren">)</span><a class="headerlink" href="#openvas.create_target" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a target that needs to be scanned</p>
<blockquote>
<div><p>curl -d ‘{“name”:”Target_name_value”, “hosts”[‘IP1’,’IP2’,’subnet1’]”}’ -H “Content-Type: application/json” -X POST <a class="reference external" href="http://localhost:5000/createTarget">http://localhost:5000/createTarget</a></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gmp</strong> – The connection created by create_connection()</p></li>
<li><p><strong>hosts</strong> – A list that contain a host, a subnet or multiple hosts</p></li>
<li><p><strong>target_name</strong> – A target name must be given</p></li>
<li><p><strong>target_comment</strong> – A target comment (notes, details etc) OPTIONAL</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The target id of the newly created target</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="openvas.create_task">
<code class="sig-prename descclassname">openvas.</code><code class="sig-name descname">create_task</code><span class="sig-paren">(</span><em class="sig-param">gmp</em>, <em class="sig-param">task_name</em>, <em class="sig-param">target_id</em>, <em class="sig-param">scanner_id='08b69003-5fc2-4037-a479-93b440211c73'</em>, <em class="sig-param">config_id='daba56c8-73ec-11df-a475-002264764cea'</em>, <em class="sig-param">task_comment=''</em><span class="sig-paren">)</span><a class="headerlink" href="#openvas.create_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a scanning task for a target or targets (depending on how many hosts the target contains)</p>
<p class="rubric">Examples</p>
<p>curl -d ‘{“name”:”Task name”, “id”:”target_id_value”}’ -H “Content-Type: application/json” -X POST <a class="reference external" href="http://localhost:5000/createTask">http://localhost:5000/createTask</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gmp</strong> – The connection created by create_connection()</p></li>
<li><p><strong>task_name</strong> – A task name must be given</p></li>
<li><p><strong>task_comment</strong> – A task comment may be given (notes, details etc) OPTIONAL</p></li>
<li><p><strong>target_id</strong> – The target_id from the targets pool</p></li>
<li><p><strong>scanned_id</strong> – The type of scanner. OpenVAS scanner is the default OPTIONAL</p></li>
<li><p><strong>config_id</strong> – The scan’s configuration file OPTIONAL</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The task id of the newly created task</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="openvas.delete_target">
<code class="sig-prename descclassname">openvas.</code><code class="sig-name descname">delete_target</code><span class="sig-paren">(</span><em class="sig-param">gmp</em>, <em class="sig-param">target_id</em><span class="sig-paren">)</span><a class="headerlink" href="#openvas.delete_target" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes a specific target</p>
<p class="rubric">Examples</p>
<p>curl -d ‘{“id”:”target_id”}’ -H “Content-Type: application/json” -X POST <a class="reference external" href="http://localhost:5000/deleteTarget">http://localhost:5000/deleteTarget</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gmp</strong> – The connection created by create_connection()</p></li>
<li><p><strong>target_id</strong> – Target id to delete</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="openvas.delete_task">
<code class="sig-prename descclassname">openvas.</code><code class="sig-name descname">delete_task</code><span class="sig-paren">(</span><em class="sig-param">gmp</em>, <em class="sig-param">task_id</em><span class="sig-paren">)</span><a class="headerlink" href="#openvas.delete_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes a specific task</p>
<p class="rubric">Examples</p>
<p>curl -X GET ‘<a class="reference external" href="http://localhost:5000/deleteTask">http://localhost:5000/deleteTask</a>’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gmp</strong> – The connection created by create_connection()</p></li>
<li><p><strong>task_id</strong> – The task id from the tasks pool.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="openvas.edit_target">
<code class="sig-prename descclassname">openvas.</code><code class="sig-name descname">edit_target</code><span class="sig-paren">(</span><em class="sig-param">gmp</em>, <em class="sig-param">target_id</em>, <em class="sig-param">hosts</em>, <em class="sig-param">target_name</em>, <em class="sig-param">target_comment=''</em>, <em class="sig-param">port_list=None</em>, <em class="sig-param">alive_tests=None</em><span class="sig-paren">)</span><a class="headerlink" href="#openvas.edit_target" title="Permalink to this definition">¶</a></dt>
<dd><p>Edit a specific target given the id</p>
<p class="rubric">Examples</p>
<p>curl -d ‘{“target_id”:”Target_id”, “hosts”:”hosts”, “target_name”:”target_name”, “comment”:”target_comment” ….}’ -H “Content-Type: application/json” -X POST <a class="reference external" href="http://localhost:5000/editTarget">http://localhost:5000/editTarget</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gmp</strong> – <p>The connection created by create_connection()</p>
<dl class="simple">
<dt>hosts</dt><dd><p>A list that contain a host, a subnet or multiple hosts OPTIONAL</p>
</dd>
<dt>target_name</dt><dd><p>A target name OPTIONAL</p>
</dd>
<dt>target_comment</dt><dd><p>A target comment (notes, details etc) OPTIONAL</p>
</dd>
<dt>port_list</dt><dd><p>Port lists standards (More details at the end of the document)</p>
</dd>
<dt>alive_test</dt><dd><p>Host probing modules</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="openvas.edit_task">
<code class="sig-prename descclassname">openvas.</code><code class="sig-name descname">edit_task</code><span class="sig-paren">(</span><em class="sig-param">gmp</em>, <em class="sig-param">task_id</em>, <em class="sig-param">task_name</em>, <em class="sig-param">target_id</em>, <em class="sig-param">scanner_id='08b69003-5fc2-4037-a479-93b440211c73'</em>, <em class="sig-param">config_id='daba56c8-73ec-11df-a475-002264764cea'</em>, <em class="sig-param">task_comment=''</em><span class="sig-paren">)</span><a class="headerlink" href="#openvas.edit_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Edit a specific task given the id</p>
<p class="rubric">Examples</p>
<p>curl -d ‘{“id”:”task_id”,”task_name”:”task_name”, “comment”:”target_comment” ,”scanner_id”:”scanner_id”, “config_id”:”config_id”,}’ -H “Content-Type: application/json” -X POST <a class="reference external" href="http://localhost:5000/editTask">http://localhost:5000/editTask</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gmp</strong> – <p>The connection created by create_connection()</p>
<p>task_id
The task id to be edited</p>
<dl class="simple">
<dt>task_name</dt><dd><p>A task name OPTIONAL</p>
</dd>
<dt>target_comment</dt><dd><p>A task comment (notes, details etc) OPTIONAL</p>
</dd>
<dt>scanned_id</dt><dd><p>The type of scanner. OpenVAS scanner is the default OPTIONAL</p>
</dd>
<dt>config_id</dt><dd><p>The scan’s configuration file OPTIONAL</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="openvas.get_all_reports">
<code class="sig-prename descclassname">openvas.</code><code class="sig-name descname">get_all_reports</code><span class="sig-paren">(</span><em class="sig-param">gmp</em><span class="sig-paren">)</span><a class="headerlink" href="#openvas.get_all_reports" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves all executed tasks’ report ids and names</p>
<p>curl -X GET ‘<a class="reference external" href="http://localhost:5000/getAllReports">http://localhost:5000/getAllReports</a>’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gmp</strong> – The connection created by create_connection()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dictionary with key value pairs. Key=Report_id, Value=Report_name</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="openvas.get_all_targets">
<code class="sig-prename descclassname">openvas.</code><code class="sig-name descname">get_all_targets</code><span class="sig-paren">(</span><em class="sig-param">gmp</em><span class="sig-paren">)</span><a class="headerlink" href="#openvas.get_all_targets" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves all previously created targets that can be used to create tasks (the targets pool)</p>
<p class="rubric">Examples</p>
<p>curl -X GET ‘<a class="reference external" href="http://localhost:5000/getAllTargets">http://localhost:5000/getAllTargets</a>’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gmp</strong> – The connection created by create_connection()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>All the created targets</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="openvas.get_all_tasks">
<code class="sig-prename descclassname">openvas.</code><code class="sig-name descname">get_all_tasks</code><span class="sig-paren">(</span><em class="sig-param">gmp</em><span class="sig-paren">)</span><a class="headerlink" href="#openvas.get_all_tasks" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves all previously created tasks (the tasks pool)</p>
<dl class="simple">
<dt>Examples</dt><dd><p>curl -X GET ‘<a class="reference external" href="http://localhost:5000/getAllTasks">http://localhost:5000/getAllTasks</a>’</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gmp</strong> – The connection created by create_connection()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>All the created tasks</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="openvas.get_report_pdf">
<code class="sig-prename descclassname">openvas.</code><code class="sig-name descname">get_report_pdf</code><span class="sig-paren">(</span><em class="sig-param">gmp</em>, <em class="sig-param">report_id</em>, <em class="sig-param">report_format_id='c402cc3e-b531-11e1-9163-406186ea4fc5'</em><span class="sig-paren">)</span><a class="headerlink" href="#openvas.get_report_pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve a report given the report_id and the report_format_id and creates a pdf(default) file with the results</p>
<p class="rubric">Examples</p>
<p>curl -d ‘{“id”:”report_id”,”format_id”:”report_format_id”}’ -H “Content-Type: application/json” -X POST <a class="reference external" href="http://localhost:5000/getReport">http://localhost:5000/getReport</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gmp</strong> – The connection created by create_connection()</p></li>
<li><p><strong>report_id</strong> – The report id from the reports pool retrieved by get_all_reports().</p></li>
<li><p><strong>report_format_id</strong> – The report’s format. Default is PDF</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="openvas.get_target">
<code class="sig-prename descclassname">openvas.</code><code class="sig-name descname">get_target</code><span class="sig-paren">(</span><em class="sig-param">gmp</em>, <em class="sig-param">target_id</em><span class="sig-paren">)</span><a class="headerlink" href="#openvas.get_target" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve a target from the target pools</p>
<p class="rubric">Examples</p>
<p>curl -d ‘{“id”:”target_id”}’ -H “Content-Type: application/json” -X POST <a class="reference external" href="http://localhost:5000/getTarget">http://localhost:5000/getTarget</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gmp</strong> – The connection created by create_connection()</p></li>
<li><p><strong>target_id</strong> – The target’s id to retrieve</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the target</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="openvas.get_task">
<code class="sig-prename descclassname">openvas.</code><code class="sig-name descname">get_task</code><span class="sig-paren">(</span><em class="sig-param">gmp</em>, <em class="sig-param">task_id</em><span class="sig-paren">)</span><a class="headerlink" href="#openvas.get_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve a task from the tasks pool</p>
<p class="rubric">Examples</p>
<p>curl -d ‘{“id”:”task_id”}’ -H “Content-Type: application/json” -X POST <a class="reference external" href="http://localhost:5000/getTask">http://localhost:5000/getTask</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gmp</strong> – The connection created by create_connection()</p></li>
<li><p><strong>task_id</strong> – The task’s id to retrieve</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the task</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="openvas.start_task">
<code class="sig-prename descclassname">openvas.</code><code class="sig-name descname">start_task</code><span class="sig-paren">(</span><em class="sig-param">gmp</em>, <em class="sig-param">task_id</em><span class="sig-paren">)</span><a class="headerlink" href="#openvas.start_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts a previously created task</p>
<dl class="simple">
<dt>Examples</dt><dd><p>curl -X GET ‘<a class="reference external" href="http://localhost:5000/startTask">http://localhost:5000/startTask</a>’</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gmp</strong> – The connection created by create_connection().</p></li>
<li><p><strong>task_id</strong> – The task id from the tasks pool.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>none</p>
</dd>
</dl>
</dd></dl>

<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="port-lists-ids-for-create-target-port-list-argument">
<h1>Port_lists IDs for create_target() port_list argument<a class="headerlink" href="#port-lists-ids-for-create-target-port-list-argument" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="id-details">
<h1>ID : Details<a class="headerlink" href="#id-details" title="Permalink to this headline">¶</a></h1>
<p>33d0cd82-57c6-11e1-8ed1-406186ea4fc5 : All IANA assigned TCP</p>
<p>4a4717fe-57d2-11e1-9a26-406186ea4fc5 : All IANA assigned TCP and UDP</p>
<p>492b72f4-56fe-11e1-98a7-406186ea4fc5 : All privileged TCP (1-1023)</p>
<p>5f2029f6-56fe-11e1-bb94-406186ea4fc5 : All privileged TCP and UDP (1-1023)</p>
<p>fd591a34-56fd-11e1-9f27-406186ea4fc5 : All TCP</p>
</div>
<div class="section" id="alive-tests-for-create-target-alive-tests-argument">
<h1>alive tests for create_target() alive_tests argument<a class="headerlink" href="#alive-tests-for-create-target-alive-tests-argument" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p>ICMP Ping</p>
<p>TCP Service Ping</p>
<p>ARP Ping</p>
<p>ICMP &amp; TCP Service Ping</p>
<p>ICMP &amp; ARP Ping</p>
<p>TCP Service &amp; ARP Ping</p>
<p>ICMP, TCP Service &amp; ARP Ping</p>
</div></blockquote>
</div>
<div class="section" id="scan-configuration-ids-for-create-task-config-id-argument">
<h1>Scan configuration IDs for create_task() config_id argument<a class="headerlink" href="#scan-configuration-ids-for-create-task-config-id-argument" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="id3">
<h1>ID : Details<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h1>
<p>8715c877-47a0-438d-98a3-27c7a6ab2196 : Network Discovery</p>
<p>daba56c8-73ec-11df-a475-002264764cea : Full and Fast</p>
<p>698f691e-7489-11df-9d8c-002264764cea : Full and Fast Ultimate</p>
<p>708f25c4-7489-11df-8094-002264764cea: Full and Very Deep</p>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">OpenVas Rest API</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Andreas Charalampous.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>